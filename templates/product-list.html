{% extends 'base.html' %}
{% load static %}

{% block title %}
  Products - TRYCCO
{% endblock %}

{% block search %}

{% endblock %}

{% block content %}
  <section class="products-page">
    <div class="container">
      <!-- Page Header -->
      {% comment %} <div class="page-header">
        <h1 class="page-title">Discover</h1>
        <p class="page-subtitle">your perfect style</p>
      </div> {% endcomment %}

      <!-- Search Section -->
      <div class="search-section">
        <div class="search-container-page">
          <input type="text" class="search-input-page" placeholder="Search products..." id="productSearch" />
          <button class="search-btn-page" aria-label="Search"><i class="fas fa-search"></i></button>
        </div>
      </div>

      <!-- Products Grid -->
      <div class="products-section">
        <div class="products-header">
          <div class="results-count">
            <span id="resultsCount">{{ products.count }}</span> articles
          </div>
          <div class="sort-container">
            <select class="sort-select" id="sortSelect">
              <option value="name">Sort by Name</option>
              <option value="price_low">Price: Low to High</option>
              <option value="price_high">Price: High to Low</option>
              <option value="newest">Newest First</option>
            </select>
          </div>
        </div>

        <div class="products-grid" id="productsGrid">
          {% for product in products %}
            <div class="product-card-listing" data-product-id="{{ product.id }}">
              <div class="product-image-container">
                {% if product.picture %}
                  <img src="{{ product.picture.url }}" alt="{{ product.name }}" class="product-image" />
                {% else %}
                  <div class="product-image-placeholder">
                    <i class="fas fa-image"></i>
                  </div>
                {% endif %}
                <div class="product-overlay">
                  <button class="quick-view-btn" data-product-id="{{ product.id }}"><i class="fas fa-eye"></i></button>
                </div>
              </div>
              <div class="product-info">
                <h3 class="product-name">{{ product.name }}</h3>
                <p class="product-price">{{ product.price }} DA</p>
                <div class="product-options">
                  <div class="available-colors">
                    {% for color in product.colors_available %}
                      <span class="color-dot" style="background-color: {{ color }};" title="{{ color }}"></span>
                    {% endfor %}
                  </div>
                  <div class="available-sizes">
                    {% for size in product.sizes_available %}
                      <span class="size-tag">{{ size }}</span>
                    {% endfor %}
                  </div>
                  <!-- Add this tags section -->
                  {% if product.tags.all %}
                    <div class="available-tags">
                      {% for tag in product.tags.all %}
                        <span class="tag-pill">{{ tag.name }}</span>
                      {% endfor %}
                    </div>
                  {% endif %}
                </div>
              </div>
            </div>
          {% endfor %}
        </div>

        <!-- Loading Indicator for Infinite Scroll -->
        <div class="loading-indicator" id="loadingIndicator" style="display: none;">
          <div class="loading-spinner"></div>
          <p>Loading more products...</p>
        </div>

        <!-- No More Products Message -->
        <div class="no-more-products" id="noMoreProducts" style="display: none;">
          <p>That's it folks !</p>
        </div>
      </div>
    </div>
  </section>
{% endblock %}
